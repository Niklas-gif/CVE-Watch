//
//  PersistentModel.swift
//  CVE-Watch
//
//  Created by Niklas Demel on 21.11.23.
//

import Foundation
import Combine

class ModelInterface {
    fileprivate var APPDATA = "appData.json"
    fileprivate var appModelData = AppDatabase.sharedInstance
    fileprivate var appModelObserver = AppObserver.sharedInstance
    
    func add(cve: Cve) {
        appModelData.appCves.append(cve)
    }
    
    func save() {
        // TODO: Implement
    }
    
    func deleted() {
        // TODO: Implement
    }
    
    func getCveData() -> [Cve] {
        return appModelData.appCves
    }
}

fileprivate class AppDatabase: ObservableObject {
    static var sharedInstance = AppDatabase()
    fileprivate var container = AppContainer()
    
    var appCves : [Cve] {
        get {
            return container.appCves
        }
        set (newAppCves)
        {
            container.appCves = newAppCves
        }
    }
    private init() {}
}

fileprivate struct AppContainer : Codable {
    private var _appCves : [Cve]?
    var appCves : [Cve] {get {return _appCves ?? []} set {_appCves = newValue}}
}

fileprivate class AppObserver : ObservableObject {
    static var sharedInstance = AppObserver()
    @Published var appModelChanged = false
}
