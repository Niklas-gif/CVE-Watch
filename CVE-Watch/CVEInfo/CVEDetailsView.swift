//
//  CVEDetailsView.swift
//  CVE-Watch
//
//  Created by Niklas Demel on 16.11.23.
//

import SwiftUI
import Charts

struct CVEDetailsView: View {
    @Binding var displayData : Cve
    @State private var isAnimating = false
    var body: some View {
        ZStack {
            Color.cveDetailView.ignoresSafeArea()
            ScrollView{
                VStack(alignment: .leading,spacing: 10){
                    Text(displayData.id).font(.largeTitle).bold()
                    Spacer(minLength: 25)
                    Text("Description").font(.title2).bold()
                    Text(displayData.descriptions[0].value).fontWeight(.medium)
                    Spacer(minLength: 25)
                    Text("Stats").font(.title2).bold()
                    Chart {
                        BarMark(x: .value("Explotability", "Explotability"), y: .value("Explotability", (displayData.metrics?.cvssMetricV31?[0].exploitabilityScore ?? 6.0)))
                        BarMark(x: .value("Impact", "ImpactScore"), y: .value("Impact", displayData.metrics?.cvssMetricV31?[0].impactScore ?? 3.0)).foregroundStyle(Color.orange)
                        BarMark(x: .value("Basescore", "Basescore"), y: .value("Basescore", displayData.metrics?.cvssMetricV31?[0].cvssData.baseScore ?? 4.5))
                            .foregroundStyle(Color.green)
                    }
                    .frame(height: 250)
                    Spacer()
                }.padding()
            }
        }
    }
}

#Preview {
    CVEDetailsView(displayData: .constant(
        Cve(id: "CVE-2019-1337", sourceIdentifier: "Source", published: "Date", lastModified: "Date", vulnStatus: "Status", descriptions: [Description(lang: "eng", value: "Desription")])))
}
